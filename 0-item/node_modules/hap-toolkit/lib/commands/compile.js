"use strict";var webpack=require("webpack"),genWebpackConf=require("../../gen-webpack-conf"),_require=require("../server/lib/utils"),colorconsole=_require.colorconsole;module.exports=function(e,o,r){var s=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};process.env.NODE_PLATFORM=e,process.env.NODE_PHASE=o;var c=genWebpackConf(s,"prod"===o?"production":"development");function a(e,o){e&&colorconsole.error(e),o.hasErrors()&&o.compilation.errors.forEach(function(e){var o=e.message,r=/Can't resolve '(sass-loader|less-loader|stylus-loader)'/.exec(o);if("ModuleNotFoundError"===e.name&&r){var s=r[1];"less-loader"===s?s="less ".concat(s):"sass-loader"===s?s="node-sass ".concat(s):"stylus-loader"===s&&(s="stylus ".concat(s)),o+=" 缺少依赖: ".concat(s,", 请执行 `npm install -D ").concat(s,"` 安装相应依赖 ")}colorconsole.error(o)})}r?webpack(c).watch({aggregateTimeout:300},a):webpack(c,a)};
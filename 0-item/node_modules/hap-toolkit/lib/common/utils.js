"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.logWarn=logWarn,exports.mkdirsSync=mkdirsSync,exports.getIPv4IPAddress=getIPv4IPAddress,exports.getServerIPAndPort=getServerIPAndPort,exports.getClientIPAddress=getClientIPAddress,exports.stripPrefixForIPV4MappedIPV6Address=stripPrefixForIPV4MappedIPV6Address,exports.outputQRCodeOnTerminal=outputQRCodeOnTerminal,exports.relatCwd=relatCwd,exports.colorconsole=void 0;var _os=_interopRequireDefault(require("os")),_fs=_interopRequireDefault(require("fs")),_path=_interopRequireDefault(require("path")),_chalk=_interopRequireDefault(require("chalk")),_qrcodeTerminal=_interopRequireDefault(require("qrcode-terminal"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var logLevelMap={};function prependLevel(e,r){var o;!logLevelMap[e]&&((o=e.toUpperCase().substr(0,4)).paddEnd&&o.paddEnd(4),logLevelMap[e]=o),"string"==typeof r[0]&&1<r[0].length&&"["!==r[0][0]&&(r[0]="[".concat(logLevelMap[e],"] ").concat(r[0]))}var colorconsole={trace:function(){for(var e,r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];prependLevel("trace",o),(e=console).trace.apply(e,o)},log:function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];prependLevel("log",r),console.log(_chalk.default.green.apply(_chalk.default,r))},info:function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];prependLevel("info",r),console.info(_chalk.default.green.apply(_chalk.default,r))},warn:function(){for(var e,r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];prependLevel("warn",o),console.warn((e=_chalk.default.yellow).bold.apply(e,o))},error:function(){for(var e,r=arguments.length,o=new Array(r),n=0;n<r;n++)o[n]=arguments[n];prependLevel("error",o),console.error((e=_chalk.default.red).bold.apply(e,o))},throw:function(){var e;throw new Error((e=_chalk.default.red).bold.apply(e,arguments))}};function logWarn(o,e,n){e&&e.length&&e.forEach(function(e){var r=e.line&&e.column?"\t@"+e.line+":"+e.column:"";n||(e.reason.startsWith("ERROR")?colorconsole.error(o.context,e.reason+r):colorconsole.warn(o.context,e.reason+r))})}function mkdirsSync(e){return!!_fs.default.existsSync(e)||(mkdirsSync(_path.default.dirname(e))?(_fs.default.mkdirSync(e),!0):void 0)}function getIPv4IPAddress(){var r,e=_os.default.networkInterfaces();for(var o in e){if(Object.prototype.hasOwnProperty.call(e,o))if(e[o].every(function(e){return!("IPv4"===e.family&&!e.internal&&"127.0.0.1"!==e.address)||(r=e,!1)}),void 0!==r)break}return r&&r.address}function getServerIPAndPort(e){return(getIPv4IPAddress()||"127.0.0.1")+"".concat(80===e?"":":"+e)}function getClientIPAddress(e){return stripPrefixForIPV4MappedIPV6Address(e.headers["x-forwarded-for"]||e.connection&&e.connection.remoteAddress||e.socket&&e.socket.remoteAddress||e.connection&&e.connection.socket&&e.connection.socket.remoteAddress)}function stripPrefixForIPV4MappedIPV6Address(e){return/^::1$/.test(e)&&(e="127.0.0.1"),/^::.{0,4}:(\d{1,3}\.){3}\d{1,3}/.test(e)&&(e=e.replace(/^.*:/,"")),e}function outputQRCodeOnTerminal(e){console.info(""),console.info("生成HTTP服务器的二维码: ".concat(e)),_qrcodeTerminal.default.generate(e,{small:!0})}exports.colorconsole=colorconsole;var CWD=process.cwd();function relatCwd(e){return _path.default.relative(CWD,e)}